<div class="uploader">
  <div
    class="dropzone"
    [class.dropzone--dragover]="dragOver()"
    (click)="fileInput.click()"
    role="button"
    tabindex="0"
    aria-label="Drag your file(s) here or click to browse"
    (keydown.enter)="fileInput.click()"
    (keydown.space)="fileInput.click()"
  >
    <div class="dropzone__content">
      <mat-icon class="dropzone__icon material-symbols-outlined"
        >upload</mat-icon
      >
      <div class="dropzone__title">
        Drag your file(s) here or click to browse
      </div>
      <button
        type="button"
        class="btn"
        (click)="$event.stopPropagation(); fileInput.click()"
        id="file-upload-input-button"
      >
        Browse files
      </button>
      <input
        #fileInput
        type="file"
        class="hidden"
        [attr.accept]="accept"
        [attr.multiple]="multiple ? '' : null"
        (change)="onFilesSelected($event)"
        id="file-upload-input"
      />
    </div>
  </div>

  <div class="uploader__footer">
    <span class="muted">Only support .csv files</span>
    <span class="muted"
      >Upload {{ items().length }} file{{
        items().length === 1 ? "" : "s"
      }}</span
    >
  </div>

  <div class="pill" *ngFor="let item of items(); let i = index">
    <mat-icon class="csv material-symbols-outlined">csv</mat-icon>
    <div class="pill__text">
      <div class="pill__title">
        {{ displayName(item.file) }}
        @switch (item.status) { @case ('uploading') {
        <span> – Uploading CSV…</span>
        } @case ('queued') {
        <span> – Queued</span>
        } @case ('done') {
        <span> – Done</span>
        } @case ('error') {
        <span> – Error</span>
        } }
      </div>
      <div class="pill__sub" *ngIf="item.message">{{ item.message }}</div>
    </div>
    <mat-icon
      class="material-symbols-outlined"
      (click)="remove(i)"
      aria-label="Remove"
      id="delete-file"
      >delete</mat-icon
    >
  </div>
</div>
